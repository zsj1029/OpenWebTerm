require=function i(r,o,s){function a(t,e){if(!o[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=o[t]={exports:{}},r[t][0].call(n.exports,function(e){return a(r[t][1][e]||e)},n,n.exports,i,r,o,s)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,n){"use strict";(e=e("guacamole-common-js"))&&e.__esModule},{"guacamole-common-js":"guacamole-common-js"}],"guacamole-common-js":[function(e,t,n){{{var O=O||{},O=(O.ArrayBufferReader=function(e){var r=this;e.onblob=function(e){for(var t=window.atob(e),e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);r.ondata&&r.ondata(e)},e.onend=function(){r.onend&&r.onend()},this.ondata=null,this.onend=null},O||{}),O=(O.ArrayBufferWriter=function(i){var r=this;function o(e){for(var t="",n=0;n<e.byteLength;n++)t+=String.fromCharCode(e[n]);i.sendBlob(window.btoa(t))}i.onack=function(e){r.onack&&r.onack(e)},this.blobLength=O.ArrayBufferWriter.DEFAULT_BLOB_LENGTH,this.sendData=function(e){var t=new Uint8Array(e);if(t.length<=r.blobLength)o(t);else for(var n=0;n<t.length;n+=r.blobLength)o(t.subarray(n,n+r.blobLength))},this.sendEnd=function(){i.sendEnd()},this.onack=null},O.ArrayBufferWriter.DEFAULT_BLOB_LENGTH=6048,O||{}),O=(O.AudioContextFactory={singleton:null,getAudioContext:function(){var e=window.AudioContext||window.webkitAudioContext;if(e)try{return O.AudioContextFactory.singleton||(O.AudioContextFactory.singleton=new e),O.AudioContextFactory.singleton}catch(e){}return null}},O||{}),O=(O.AudioPlayer=function(){this.sync=function(){}},O.AudioPlayer.isSupportedType=function(e){return O.RawAudioPlayer.isSupportedType(e)},O.AudioPlayer.getSupportedTypes=function(){return O.RawAudioPlayer.getSupportedTypes()},O.AudioPlayer.getInstance=function(e,t){return O.RawAudioPlayer.isSupportedType(t)?new O.RawAudioPlayer(e,t):null},O.RawAudioPlayer=function(e,t){var u=O.RawAudioFormat.parse(t),c=O.AudioContextFactory.getAudioContext(),l=c.currentTime,t=new O.ArrayBufferReader(e),h=.02,d=1===u.bytesPerSample?window.Int8Array:window.Int16Array,f=1===u.bytesPerSample?128:32768,n=[],i=function(e){var t,n,i;return e.length<=1?e[0]:(t=0,e.forEach(function(e){t+=e.length}),n=0,i=new d(t),e.forEach(function(e){i.set(e,n),n+=e.length}),i)},r=function(e){for(var t=Number.MAX_VALUE,n=e.length,i=Math.floor(e.length/u.channels),r=Math.floor(u.rate*h),o=Math.max(u.channels*r,u.channels*(i-r));o<e.length;o+=u.channels){for(var s=0,a=0;a<u.channels;a++)s+=Math.abs(e[o+a]);s<=t&&(n=o+u.channels,t=s)}return n===e.length?[e]:[new d(e.buffer.slice(0,n*u.bytesPerSample)),new d(e.buffer.slice(n*u.bytesPerSample))]};t.ondata=function(e){e=new d(e),n.push(new d(e));var t,e=(e=i(n))?(n=r(e)).shift():null;e&&(t=c.currentTime,l<t&&(l=t),(t=c.createBufferSource()).connect(c.destination),t.start||(t.start=t.noteOn),t.buffer=function(e){for(var t=e.length/u.channels,n=c.currentTime,i=(l<n&&(l=n),c.createBuffer(u.channels,t,u.rate)),r=0;r<u.channels;r++)for(var o=i.getChannelData(r),s=r,a=0;a<t;a++)o[a]=e[s]/f,s+=u.channels;return i}(e),t.start(l),l+=e.length/u.channels/u.rate)},this.sync=function(){var e=c.currentTime;l=Math.min(l,e+.3)}},O.RawAudioPlayer.prototype=new O.AudioPlayer,O.RawAudioPlayer.isSupportedType=function(e){return!!O.AudioContextFactory.getAudioContext()&&null!==O.RawAudioFormat.parse(e)},O.RawAudioPlayer.getSupportedTypes=function(){return O.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]},O||{}),O=(O.AudioRecorder=function(){this.onclose=null,this.onerror=null},O.AudioRecorder.isSupportedType=function(e){return O.RawAudioRecorder.isSupportedType(e)},O.AudioRecorder.getSupportedTypes=function(){return O.RawAudioRecorder.getSupportedTypes()},O.AudioRecorder.getInstance=function(e,t){return O.RawAudioRecorder.isSupportedType(t)?new O.RawAudioRecorder(e,t):null},O.RawAudioRecorder=function(e,t){var i=this,n=2048,s=3,u=O.RawAudioFormat.parse(t),r=O.AudioContextFactory.getAudioContext(),o=(navigator.mediaDevices||(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia||(navigator.mediaDevices.getUserMedia=(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).bind(navigator)),new O.ArrayBufferWriter(e)),c=1===u.bytesPerSample?window.Int8Array:window.Int16Array,l=1===u.bytesPerSample?128:32768,h=0,d=0,a=null,f=null,p=null,g=function(e){return 0===e?1:(e=Math.PI*e,Math.sin(e)/e)},y=function(e,t){return-t<e&&e<t?g(e)*g(e/t):0},m=function(e,t){for(var n=(e.length-1)*t,t=Math.floor(n)-s+1,i=Math.floor(n)+s,r=0,o=t;o<=i;o++)r+=(e[o]||0)*y(n-o,s);return r},v=function(e){var t=e.length;h+=t;for(var n=Math.round(h*u.rate/e.sampleRate)-d,i=(d+=n,new c(n*u.channels)),r=0;r<u.channels;r++)for(var o=e.getChannelData(r),s=r,a=0;a<n;a++)i[s]=m(o,a/(n-1))*l,s+=u.channels;return i},w=function(e){(p=r.createScriptProcessor(n,u.channels,u.channels)).connect(r.destination),p.onaudioprocess=function(e){o.sendData(v(e.inputBuffer).buffer)},(f=r.createMediaStreamSource(e)).connect(p),"suspended"===r.state&&r.resume(),a=e},S=function(){o.sendEnd(),i.onerror&&i.onerror()};o.onack=function(e){if(e.code!==O.Status.Code.SUCCESS||a){if(f&&f.disconnect(),p&&p.disconnect(),a)for(var t=a.getTracks(),n=0;n<t.length;n++)t[n].stop();a=f=p=null,o.sendEnd(),o.onack=null,e.code===O.Status.Code.RESOURCE_CLOSED?i.onclose&&i.onclose():i.onerror&&i.onerror()}else(e=navigator.mediaDevices.getUserMedia({audio:!0},w,S))&&e.then&&e.then(w,S)}},O.RawAudioRecorder.prototype=new O.AudioRecorder,O.RawAudioRecorder.isSupportedType=function(e){return!!O.AudioContextFactory.getAudioContext()&&null!==O.RawAudioFormat.parse(e)},O.RawAudioRecorder.getSupportedTypes=function(){return O.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]},O||{}),O=(O.BlobReader=function(r,n){var o=this,s=0,a=new(window.BlobBuilder?BlobBuilder:window.WebKitBlobBuilder?WebKitBlobBuilder:window.MozBlobBuilder?MozBlobBuilder:function(){var t=[];this.append=function(e){t.push(new Blob([e],{type:n}))},this.getBlob=function(){return new Blob(t,{type:n})}});r.onblob=function(e){for(var t=window.atob(e),e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);a.append(e),s+=e.byteLength,o.onprogress&&o.onprogress(e.byteLength),r.sendAck("OK",0)},r.onend=function(){o.onend&&o.onend()},this.getLength=function(){return s},this.getBlob=function(){return a.getBlob()},this.onprogress=null,this.onend=null},O||{}),O=(O.BlobWriter=function(e){var o=this,s=new O.ArrayBufferWriter(e);s.onack=function(e){o.onack&&o.onack(e)};this.sendBlob=function(t){function n(){var e;i>=t.size?o.oncomplete&&o.oncomplete(t):(e=function(e,t,n){var e=(e.slice||e.webkitSlice||e.mozSlice).bind(e),i=n-t;if(i!==n){var r=e(t,i);if(r.size===i)return r}return e(t,n)}(t,i,i+s.blobLength),i+=s.blobLength,r.readAsArrayBuffer(e))}var i=0,r=new FileReader;r.onload=function(){s.sendData(r.result),s.onack=function(e){o.onack&&o.onack(e),e.isError()||(o.onprogress&&o.onprogress(t,i-s.blobLength),n())}},r.onerror=function(){o.onerror&&o.onerror(t,i,r.error)},n()},this.sendEnd=function(){s.sendEnd()},this.onack=null,this.onerror=null,this.onprogress=null,this.oncomplete=null},O||{}),O=(O.Client=function(r){var s=this,n=2,i=3,u=0,c=0,t=null,l={0:"butt",1:"round",2:"square"},h={0:"bevel",1:"miter",2:"round"},d=new O.Display,f={},o={},a=[],p=[],g=[],y=new O.IntegerPool,m=[];function v(e){e!=u&&(u=e,s.onstatechange&&s.onstatechange(u))}function w(){return u==i||u==n}this.exportState=function(o){var e,s={currentState:u,currentTimestamp:c,layers:{}},a={};for(e in f)a[e]=f[e];d.flush(function(){for(var e in a){var t=parseInt(e),n=a[e],i=n.toCanvas(),r={width:n.width,height:n.height};n.width&&n.height&&(r.url=i.toDataURL("image/png")),0<t&&(r.x=n.x,r.y=n.y,r.z=n.z,r.alpha=n.alpha,r.matrix=n.matrix,r.parent=T(n.parent)),s.layers[e]=r}o(s)})},this.importState=function(e,t){for(var n in u=e.currentState,c=e.currentTimestamp,f)0<(r=parseInt(n))&&d.dispose(f[n]);for(n in f={},e.layers){var i,r=parseInt(n),o=e.layers[n],s=S(r);d.resize(s,o.width,o.height),o.url&&(d.setChannelMask(s,O.Layer.SRC),d.draw(s,0,0,o.url)),0<r&&0<=o.parent&&(i=S(o.parent),d.move(s,i,o.x,o.y,o.z),d.shade(s,o.alpha),i=o.matrix,d.distort(s,i[0],i[1],i[2],i[3],i[4],i[5]))}d.flush(t)},this.getDisplay=function(){return d},this.sendSize=function(e,t){w()&&r.sendMessage("size",e,t)},this.sendKeyEvent=function(e,t){w()&&r.sendMessage("key",t,e)},this.sendMouseState=function(e,t){var n,i;w()&&(n=e.x,i=e.y,t&&(n/=d.getScale(),i/=d.getScale()),d.moveCursor(Math.floor(n),Math.floor(i)),t=0,e.left&&(t|=1),e.middle&&(t|=2),e.right&&(t|=4),e.up&&(t|=8),e.down&&(t|=16),r.sendMessage("mouse",Math.floor(n),Math.floor(i),t))},this.sendTouchState=function(e,t){var n,i;w()&&(n=e.x,i=e.y,t&&(n/=d.getScale(),i/=d.getScale()),r.sendMessage("touch",e.id,Math.floor(n),Math.floor(i),Math.floor(e.radiusX),Math.floor(e.radiusY),e.angle,e.force))},this.createOutputStream=function(){var e=y.next();return m[e]=new O.OutputStream(s,e)},this.createAudioStream=function(e){var t=s.createOutputStream();return r.sendMessage("audio",t.index,e),t},this.createFileStream=function(e,t){var n=s.createOutputStream();return r.sendMessage("file",n.index,e,t),n},this.createPipeStream=function(e,t){var n=s.createOutputStream();return r.sendMessage("pipe",n.index,e,t),n},this.createClipboardStream=function(e){var t=s.createOutputStream();return r.sendMessage("clipboard",t.index,e),t},this.createArgumentValueStream=function(e,t){var n=s.createOutputStream();return r.sendMessage("argv",n.index,e,t),n},this.createObjectOutputStream=function(e,t,n){var i=s.createOutputStream();return r.sendMessage("put",e,i.index,t,n),i},this.requestObjectInputStream=function(e,t){w()&&r.sendMessage("get",e,t)},this.sendAck=function(e,t,n){w()&&r.sendMessage("ack",e,t,n)},this.sendBlob=function(e,t){w()&&r.sendMessage("blob",e,t)},this.endStream=function(e){w()&&(r.sendMessage("end",e),m[e]&&(y.free(e),delete m[e]))},this.onstatechange=null,this.onname=null,this.onerror=null,this.onaudio=null,this.onvideo=null,this.onmultitouch=null,this.onargv=null,this.onclipboard=null,this.onfile=null,this.onfilesystem=null,this.onpipe=null,this.onrequired=null,this.onsync=null;var S=function(e){var t=f[e];return t||(t=0===e?d.getDefaultLayer():0<e?d.createLayer():d.createBuffer(),f[e]=t),t},T=function(e){if(e)for(var t in f)if(e===f[t])return parseInt(t);return null};var E={"miter-limit":function(e,t){d.setMiterLimit(e,parseFloat(t))},"multi-touch":function(e,t){s.onmultitouch&&e instanceof O.Display.VisibleLayer&&s.onmultitouch(e,parseInt(t))}},b={ack:function(e){var t=parseInt(e[0]),n=e[1],e=parseInt(e[2]),i=m[t];i&&(i.onack&&i.onack(new O.Status(e,n)),256<=e&&m[t]===i&&(y.free(t),delete m[t]))},arc:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),i=parseInt(e[2]),r=parseInt(e[3]),o=parseFloat(e[4]),s=parseFloat(e[5]),e=parseInt(e[6]);d.arc(t,n,i,r,o,s,0!=e)},argv:function(e){var t,n=parseInt(e[0]),i=e[1],e=e[2];s.onargv?(t=p[n]=new O.InputStream(s,n),s.onargv(t,i,e)):s.sendAck(n,"Receiving argument values unsupported",256)},audio:function(e){var t=parseInt(e[0]),e=e[1],n=p[t]=new O.InputStream(s,t),i=null;(i=(i=s.onaudio?s.onaudio(n,e):i)||O.AudioPlayer.getInstance(n,e))?(o[t]=i,s.sendAck(t,"OK",0)):s.sendAck(t,"BAD TYPE",783)},blob:function(e){var t=parseInt(e[0]),e=e[1],t=p[t];t&&t.onblob&&t.onblob(e)},body:function(e){var t,n=parseInt(e[0]),n=g[n],i=parseInt(e[1]),r=e[2],e=e[3];n&&n.onbody?(t=p[i]=new O.InputStream(s,i),n.onbody(t,r,e)):s.sendAck(i,"Receipt of body unsupported",256)},cfill:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),i=parseInt(e[2]),r=parseInt(e[3]),o=parseInt(e[4]),e=parseInt(e[5]);d.setChannelMask(n,t),d.fillColor(n,i,r,o,e)},clip:function(e){e=S(parseInt(e[0]));d.clip(e)},clipboard:function(e){var t,n=parseInt(e[0]),e=e[1];s.onclipboard?(t=p[n]=new O.InputStream(s,n),s.onclipboard(t,e)):s.sendAck(n,"Clipboard unsupported",256)},close:function(e){e=S(parseInt(e[0]));d.close(e)},copy:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),i=parseInt(e[2]),r=parseInt(e[3]),o=parseInt(e[4]),s=parseInt(e[5]),a=S(parseInt(e[6])),u=parseInt(e[7]),e=parseInt(e[8]);d.setChannelMask(a,s),d.copy(t,n,i,r,o,a,u,e)},cstroke:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),i=l[parseInt(e[2])],r=h[parseInt(e[3])],o=parseInt(e[4]),s=parseInt(e[5]),a=parseInt(e[6]),u=parseInt(e[7]),e=parseInt(e[8]);d.setChannelMask(n,t),d.strokeColor(n,i,r,o,s,a,u,e)},cursor:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),i=S(parseInt(e[2])),r=parseInt(e[3]),o=parseInt(e[4]),s=parseInt(e[5]),e=parseInt(e[6]);d.setCursor(t,n,i,r,o,s,e)},curve:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),i=parseInt(e[2]),r=parseInt(e[3]),o=parseInt(e[4]),s=parseInt(e[5]),e=parseInt(e[6]);d.curveTo(t,n,i,r,o,s,e)},disconnect:function(e){s.disconnect()},dispose:function(e){var t,e=parseInt(e[0]);0<e?(t=S(e),d.dispose(t),delete f[e]):e<0&&delete f[e]},distort:function(e){var t=parseInt(e[0]),n=parseFloat(e[1]),i=parseFloat(e[2]),r=parseFloat(e[3]),o=parseFloat(e[4]),s=parseFloat(e[5]),e=parseFloat(e[6]);0<=t&&(t=S(t),d.distort(t,n,i,r,o,s,e))},error:function(e){var t=e[0],e=parseInt(e[1]);s.onerror&&s.onerror(new O.Status(e,t)),s.disconnect()},end:function(e){var e=parseInt(e[0]),t=p[e];t&&(t.onend&&t.onend(),delete p[e])},file:function(e){var t,n=parseInt(e[0]),i=e[1],e=e[2];s.onfile?(t=p[n]=new O.InputStream(s,n),s.onfile(t,i,e)):s.sendAck(n,"File transfer unsupported",256)},filesystem:function(e){var t=parseInt(e[0]),e=e[1];s.onfilesystem&&(t=g[t]=new O.Object(s,t),s.onfilesystem(t,e))},identity:function(e){e=S(parseInt(e[0]));d.setTransform(e,1,0,0,1,0,0)},img:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),i=S(parseInt(e[2])),r=e[3],o=parseInt(e[4]),e=parseInt(e[5]),t=p[t]=new O.InputStream(s,t);d.setChannelMask(i,n),d.drawStream(i,o,e,t,r)},jpeg:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),i=parseInt(e[2]),r=parseInt(e[3]),e=e[4];d.setChannelMask(n,t),d.draw(n,i,r,"data:image/jpeg;base64,"+e)},lfill:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),e=S(parseInt(e[2]));d.setChannelMask(n,t),d.fillLayer(n,e)},line:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),e=parseInt(e[2]);d.lineTo(t,n,e)},lstroke:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),e=S(parseInt(e[2]));d.setChannelMask(n,t),d.strokeLayer(n,e)},mouse:function(e){var t=parseInt(e[0]),e=parseInt(e[1]);d.showCursor(!0),d.moveCursor(t,e)},move:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),i=parseInt(e[2]),r=parseInt(e[3]),e=parseInt(e[4]);0<t&&0<=n&&(t=S(t),n=S(n),d.move(t,n,i,r,e))},name:function(e){s.onname&&s.onname(e[0])},nest:function(e){var t,n;t=parseInt(e[0]),null==(n=a[t])&&((n=a[t]=new O.Parser).oninstruction=r.oninstruction),n.receive(e[1])},pipe:function(e){var t,n=parseInt(e[0]),i=e[1],e=e[2];s.onpipe?(t=p[n]=new O.InputStream(s,n),s.onpipe(t,i,e)):s.sendAck(n,"Named pipes unsupported",256)},png:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),i=parseInt(e[2]),r=parseInt(e[3]),e=e[4];d.setChannelMask(n,t),d.draw(n,i,r,"data:image/png;base64,"+e)},pop:function(e){e=S(parseInt(e[0]));d.pop(e)},push:function(e){e=S(parseInt(e[0]));d.push(e)},rect:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),i=parseInt(e[2]),r=parseInt(e[3]),e=parseInt(e[4]);d.rect(t,n,i,r,e)},required:function(e){s.onrequired&&s.onrequired(e)},reset:function(e){e=S(parseInt(e[0]));d.reset(e)},set:function(e){var t=S(parseInt(e[0])),n=e[1],e=e[2],n=E[n];n&&n(t,e)},shade:function(e){var t=parseInt(e[0]),e=parseInt(e[1]);0<=t&&(t=S(t),d.shade(t,e))},size:function(e){var t=parseInt(e[0]),t=S(t),n=parseInt(e[1]),e=parseInt(e[2]);d.resize(t,n,e)},start:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),e=parseInt(e[2]);d.moveTo(t,n,e)},sync:function(e){var t=parseInt(e[0]);d.flush(function(){for(var e in o){e=o[e];e&&e.sync()}t!==c&&(r.sendMessage("sync",t),c=t)}),u===n&&v(i),s.onsync&&s.onsync(t)},transfer:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),i=parseInt(e[2]),r=parseInt(e[3]),o=parseInt(e[4]),s=parseInt(e[5]),a=S(parseInt(e[6])),u=parseInt(e[7]),e=parseInt(e[8]);3===s?d.put(t,n,i,r,o,a,u,e):5!==s&&d.transfer(t,n,i,r,o,a,u,e,O.Client.DefaultTransferFunction[s])},transform:function(e){var t=S(parseInt(e[0])),n=parseFloat(e[1]),i=parseFloat(e[2]),r=parseFloat(e[3]),o=parseFloat(e[4]),s=parseFloat(e[5]),e=parseFloat(e[6]);d.transform(t,n,i,r,o,s,e)},undefine:function(e){e=parseInt(e[0]),e=g[e];e&&e.onundefine&&e.onundefine()},video:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),e=e[2],i=p[t]=new O.InputStream(s,t),r=null;(r=(r=s.onvideo?s.onvideo(i,n,e):r)||O.VideoPlayer.getInstance(i,n,e))?(t,s.sendAck(t,"OK",0)):s.sendAck(t,"BAD TYPE",783)}};r.oninstruction=function(e,t){e=b[e];e&&e(t)},this.disconnect=function(){5!=u&&4!=u&&(v(4),t&&window.clearInterval(t),r.sendMessage("disconnect"),r.disconnect(),v(5))},this.connect=function(e){v(1);try{r.connect(e)}catch(e){throw v(0),e}t=window.setInterval(function(){r.sendMessage("nop")},5e3),v(n)}},O.Client.DefaultTransferFunction={0:function(e,t){t.red=t.green=t.blue=0},15:function(e,t){t.red=t.green=t.blue=255},3:function(e,t){t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha},5:function(e,t){},12:function(e,t){t.red=255&~e.red,t.green=255&~e.green,t.blue=255&~e.blue,t.alpha=e.alpha},10:function(e,t){t.red=255&~t.red,t.green=255&~t.green,t.blue=255&~t.blue},1:function(e,t){t.red=e.red&t.red,t.green=e.green&t.green,t.blue=e.blue&t.blue},14:function(e,t){t.red=255&~(e.red&t.red),t.green=255&~(e.green&t.green),t.blue=255&~(e.blue&t.blue)},7:function(e,t){t.red=e.red|t.red,t.green=e.green|t.green,t.blue=e.blue|t.blue},8:function(e,t){t.red=255&~(e.red|t.red),t.green=255&~(e.green|t.green),t.blue=255&~(e.blue|t.blue)},6:function(e,t){t.red=e.red^t.red,t.green=e.green^t.green,t.blue=e.blue^t.blue},9:function(e,t){t.red=255&~(e.red^t.red),t.green=255&~(e.green^t.green),t.blue=255&~(e.blue^t.blue)},4:function(e,t){t.red=~e.red&t.red&255,t.green=~e.green&t.green&255,t.blue=~e.blue&t.blue&255},13:function(e,t){t.red=255&(~e.red|t.red),t.green=255&(~e.green|t.green),t.blue=255&(~e.blue|t.blue)},2:function(e,t){t.red=e.red&~t.red&255,t.green=e.green&~t.green&255,t.blue=e.blue&~t.blue&255},11:function(e,t){t.red=255&(e.red|~t.red),t.green=255&(e.green|~t.green),t.blue=255&(e.blue|~t.blue)}},O||{}),O=(O.DataURIReader=function(e,t){var n=this,i="data:"+t+";base64,";e.onblob=function(e){i+=e},e.onend=function(){n.onend&&n.onend()},this.getURI=function(){return i},this.onend=null},O||{});O.Display=function(){var a=this,i=0,r=0,o=1,s=document.createElement("div"),c=(s.style.position="relative",s.style.width=i+"px",s.style.height=r+"px",s.style.transformOrigin=s.style.webkitTransformOrigin=s.style.MozTransformOrigin=s.style.OTransformOrigin=s.style.msTransformOrigin="0 0",new O.Display.VisibleLayer(i,r)),u=new O.Display.VisibleLayer(0,0),l=(u.setChannelMask(O.Layer.SRC),s.appendChild(c.getElement()),s.appendChild(u.getElement()),document.createElement("div")),n=(l.style.position="relative",l.style.width=i*o+"px",l.style.height=r*o+"px",l.appendChild(s),this.cursorHotspotX=0,this.cursorHotspotY=0,this.cursorX=0,this.cursorY=0,this.onresize=null,this.oncursor=null,[]),h=[];function d(){for(var e=0;e<h.length;){var t=h[e];if(!t.isReady())break;t.flush(),e++}h.splice(0,e)}function t(t,n){this.isReady=function(){for(var e=0;e<n.length;e++)if(n[e].blocked)return!1;return!0},this.flush=function(){for(var e=0;e<n.length;e++)n[e].execute();t&&t()}}function f(e,t){var n=this;this.blocked=t,this.unblock=function(){n.blocked&&(n.blocked=!1,d())},this.execute=function(){e&&e()}}function p(e,t){e=new f(e,t);return n.push(e),e}this.getElement=function(){return l},this.getWidth=function(){return i},this.getHeight=function(){return r},this.getDefaultLayer=function(){return c},this.getCursorLayer=function(){return u},this.createLayer=function(){var e=new O.Display.VisibleLayer(i,r);return e.move(c,0,0,0),e},this.createBuffer=function(){var e=new O.Layer(0,0);return e.autosize=1,e},this.flush=function(e){h.push(new t(e,n)),n=[],d()},this.setCursor=function(e,t,n,i,r,o,s){p(function(){a.cursorHotspotX=e,a.cursorHotspotY=t,u.resize(o,s),u.copy(n,i,r,o,s,0,0),a.moveCursor(a.cursorX,a.cursorY),a.oncursor&&a.oncursor(u.toCanvas(),e,t)})},this.showCursor=function(e){var t=u.getElement(),n=t.parentNode;!1===e?n&&n.removeChild(t):n!==s&&s.appendChild(t)},this.moveCursor=function(e,t){u.translate(e-a.cursorHotspotX,t-a.cursorHotspotY),a.cursorX=e,a.cursorY=t},this.resize=function(e,t,n){p(function(){e.resize(t,n),e===c&&(i=t,r=n,s.style.width=i+"px",s.style.height=r+"px",l.style.width=i*o+"px",l.style.height=r*o+"px",a.onresize&&a.onresize(t,n))})},this.drawImage=function(e,t,n,i){p(function(){e.drawImage(t,n,i)})},this.drawBlob=function(e,t,n,i){var r,o,s,a;window.createImageBitmap?(o=p(function(){e.drawImage(t,n,r)},!0),window.createImageBitmap(i).then(function(e){r=e,o.unblock()})):(s=URL.createObjectURL(i),o=p(function(){a.width&&a.height&&e.drawImage(t,n,a),URL.revokeObjectURL(s)},!0),(a=new Image).onload=o.unblock,a.onerror=o.unblock,a.src=s)},this.drawStream=function(e,t,n,i,r){var o;window.createImageBitmap?(o=new O.BlobReader(i,r)).onend=function(){a.drawBlob(e,t,n,o.getBlob())}:(o=new O.DataURIReader(i,r)).onend=function(){a.draw(e,t,n,o.getURI())}},this.draw=function(e,t,n,i){var r=p(function(){o.width&&o.height&&e.drawImage(t,n,o)},!0),o=new Image;o.onload=r.unblock,o.onerror=r.unblock,o.src=i},this.play=function(t,e,n,i){var r=document.createElement("video");r.type=e,r.src=i,r.addEventListener("play",function(){!function e(){t.drawImage(0,0,r),r.ended||window.setTimeout(e,20)}()},!1),p(r.play)},this.transfer=function(e,t,n,i,r,o,s,a,u){p(function(){o.transfer(e,t,n,i,r,s,a,u)})},this.put=function(e,t,n,i,r,o,s,a){p(function(){o.put(e,t,n,i,r,s,a)})},this.copy=function(e,t,n,i,r,o,s,a){p(function(){o.copy(e,t,n,i,r,s,a)})},this.moveTo=function(e,t,n){p(function(){e.moveTo(t,n)})},this.lineTo=function(e,t,n){p(function(){e.lineTo(t,n)})},this.arc=function(e,t,n,i,r,o,s){p(function(){e.arc(t,n,i,r,o,s)})},this.curveTo=function(e,t,n,i,r,o,s){p(function(){e.curveTo(t,n,i,r,o,s)})},this.close=function(e){p(function(){e.close()})},this.rect=function(e,t,n,i,r){p(function(){e.rect(t,n,i,r)})},this.clip=function(e){p(function(){e.clip()})},this.strokeColor=function(e,t,n,i,r,o,s,a){p(function(){e.strokeColor(t,n,i,r,o,s,a)})},this.fillColor=function(e,t,n,i,r){p(function(){e.fillColor(t,n,i,r)})},this.strokeLayer=function(e,t,n,i,r){p(function(){e.strokeLayer(t,n,i,r)})},this.fillLayer=function(e,t){p(function(){e.fillLayer(t)})},this.push=function(e){p(function(){e.push()})},this.pop=function(e){p(function(){e.pop()})},this.reset=function(e){p(function(){e.reset()})},this.setTransform=function(e,t,n,i,r,o,s){p(function(){e.setTransform(t,n,i,r,o,s)})},this.transform=function(e,t,n,i,r,o,s){p(function(){e.transform(t,n,i,r,o,s)})},this.setChannelMask=function(e,t){p(function(){e.setChannelMask(t)})},this.setMiterLimit=function(e,t){p(function(){e.setMiterLimit(t)})},this.dispose=function(e){p(function(){e.dispose()})},this.distort=function(e,t,n,i,r,o,s){p(function(){e.distort(t,n,i,r,o,s)})},this.move=function(e,t,n,i,r){p(function(){e.move(t,n,i,r)})},this.shade=function(e,t){p(function(){e.shade(t)})},this.scale=function(e){s.style.transform=s.style.WebkitTransform=s.style.MozTransform=s.style.OTransform=s.style.msTransform="scale("+e+","+e+")",o=e,l.style.width=i*o+"px",l.style.height=r*o+"px"},this.getScale=function(){return o},this.flatten=function(){var e=document.createElement("canvas"),u=(e.width=c.width,e.height=c.height,e.getContext("2d"));return function e(t,n,i){if(0<t.width&&0<t.height){for(var r=u.globalAlpha,o=(u.globalAlpha*=t.alpha/255,u.drawImage(t.getCanvas(),n,i),function(e){var t,n=[];for(t in e.children)n.push(e.children[t]);return n.sort(function(e,t){var n=e.z-t.z;return 0!=n?n:(n=e.getElement(),(e=t.getElement().compareDocumentPosition(n))&Node.DOCUMENT_POSITION_PRECEDING?-1:e&Node.DOCUMENT_POSITION_FOLLOWING?1:0)}),n}(t)),s=0;s<o.length;s++){var a=o[s];e(a,n+a.x,i+a.y)}u.globalAlpha=r}}(c,0,0),e}},O.Display.VisibleLayer=function(e,t){O.Layer.apply(this,[e,t]);var s=this,n=(this.__unique_id=O.Display.VisibleLayer.__next_id++,this.alpha=255,this.x=0,this.y=0,this.z=0,this.matrix=[1,0,0,1,0,0],this.parent=null,this.children={},s.getCanvas()),a=(n.style.position="absolute",n.style.left="0px",n.style.top="0px",document.createElement("div")),i=(a.appendChild(n),a.style.width=e+"px",a.style.height=t+"px",a.style.position="absolute",a.style.left="0px",a.style.top="0px",a.style.overflow="hidden",this.resize),u=(this.resize=function(e,t){a.style.width=e+"px",a.style.height=t+"px",i(e,t)},this.getElement=function(){return a},"translate(0px, 0px)"),c="matrix(1, 0, 0, 1, 0, 0)";this.translate=function(e,t){s.x=e,s.y=t,u="translate("+e+"px,"+t+"px)",a.style.transform=a.style.WebkitTransform=a.style.MozTransform=a.style.OTransform=a.style.msTransform=u+" "+c},this.move=function(e,t,n,i){s.parent!==e&&(s.parent&&delete s.parent.children[s.__unique_id],(s.parent=e).children[s.__unique_id]=s,e.getElement().appendChild(a)),s.translate(t,n),s.z=i,a.style.zIndex=i},this.shade=function(e){s.alpha=e,a.style.opacity=e/255},this.dispose=function(){s.parent&&(delete s.parent.children[s.__unique_id],s.parent=null),a.parentNode&&a.parentNode.removeChild(a)},this.distort=function(e,t,n,i,r,o){s.matrix=[e,t,n,i,r,o],c="matrix("+e+","+t+","+n+","+i+","+r+","+o+")",a.style.transform=a.style.WebkitTransform=a.style.MozTransform=a.style.OTransform=a.style.msTransform=u+" "+c}},O.Display.VisibleLayer.__next_id=0;var O,O,O,O,O,O,O,O,O,O,O,O}(O=O||{}).Event=function(e){this.type=e,this.timestamp=(new Date).getTime(),this.getAge=function(){return(new Date).getTime()-this.timestamp},this.invokeLegacyHandler=function(e){}},O.Event.DOMEvent=function(e,t){O.Event.call(this,e),t=t||[],Array.isArray(t)||(t=[t]),this.preventDefault=function(){t.forEach(function(e){e.preventDefault&&e.preventDefault(),e.returnValue=!1})},this.stopPropagation=function(){t.forEach(function(e){e.stopPropagation()})}},O.Event.DOMEvent.cancelEvent=function(e){e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1},O.Event.Target=function(){var r={};this.on=function(e,t){var n=r[e];n||(r[e]=n=[]),n.push(t)},this.onEach=function(e,t){e.forEach(function(e){this.on(e,t)},this)},this.dispatch=function(e){e.invokeLegacyHandler(this);var t=r[e.type];if(t)for(var n=0;n<t.length;n++)t[n](e,this)},this.off=function(e,t){var n=r[e];if(n)for(var i=0;i<n.length;i++)if(n[i]===t)return n.splice(i,1),!0;return!1},this.offEach=function(e,t){var n=!1;return e.forEach(function(e){n|=this.off(e,t)},this),n}},(O=O||{}).InputSink=function(){var n=this,t=document.createElement("textarea");t.style.position="fixed",t.style.outline="none",t.style.border="none",t.style.margin="0",t.style.padding="0",t.style.height="0",t.style.width="0",t.style.left="0",t.style.bottom="0",t.style.resize="none",t.style.background="transparent",t.style.color="transparent",t.addEventListener("keypress",function(e){t.value=""},!1),t.addEventListener("compositionend",function(e){e.data&&(t.value="")},!1),t.addEventListener("input",function(e){e.data&&!e.isComposing&&(t.value="")},!1),t.addEventListener("focus",function(){window.setTimeout(function(){t.click(),t.select()},0)},!0),this.focus=function(){window.setTimeout(function(){t.focus()},0)},this.getElement=function(){return t},document.addEventListener("keydown",function(e){var t=document.activeElement;if(t&&t!==document.body){t=t.getBoundingClientRect();if(0<t.left+t.width&&0<t.top+t.height)return}n.focus()},!0)},(O=O||{}).InputStream=function(n,e){var i=this;this.index=e,this.onblob=null,this.onend=null,this.sendAck=function(e,t){n.sendAck(i.index,e,t)}},(O=O||{}).IntegerPool=function(){var e=this,t=[];this.next_int=0,this.next=function(){return 0<t.length?t.shift():e.next_int++},this.free=function(e){t.push(e)}},(O=O||{}).JSONReader=function(e){var t=this,e=new O.StringReader(e),n="";this.getLength=function(){return n.length},this.getJSON=function(){return JSON.parse(n)},e.ontext=function(e){n+=e,t.onprogress&&t.onprogress(e.length)},e.onend=function(){t.onend&&t.onend()},this.onprogress=null,this.onend=null},(O=O||{}).Keyboard=function(e){var o=this,t="_GUAC_KEYBOARD_HANDLED_BY_"+O.Keyboard._nextID++,s=(this.onkeydown=null,this.onkeyup=null,{keyupUnreliable:!1,altIsTypableOnly:!1,capsLockKeyupUnreliable:!1}),n=(navigator&&navigator.platform&&(navigator.platform.match(/ipad|iphone|ipod/i)?s.keyupUnreliable=!0:navigator.platform.match(/^mac/i)&&(s.altIsTypableOnly=!0,s.capsLockKeyupUnreliable=!0)),function(e){var t=this;this.keyCode=e?e.which||e.keyCode:0,this.keyIdentifier=e&&e.keyIdentifier,this.key=e&&e.key,this.location=e?R(e):0,this.modifiers=e?O.Keyboard.ModifierState.fromKeyboardEvent(e):new O.Keyboard.ModifierState,this.timestamp=(new Date).getTime(),this.defaultPrevented=!1,this.keysym=null,this.reliable=!1,this.getAge=function(){return(new Date).getTime()-t.timestamp}}),a=function(e){n.call(this,e),this.keysym=w(this.key,this.location)||T(this.keyCode,this.location),this.keyupReliable=!s.keyupUnreliable,this.keysym&&!v(this.keysym)&&(this.reliable=!0),!this.keysym&&E(this.keyCode,this.keyIdentifier)&&(this.keysym=w(this.keyIdentifier,this.location,this.modifiers.shift)),(this.modifiers.meta&&65511!==this.keysym&&65512!==this.keysym||65509===this.keysym&&s.capsLockKeyupUnreliable)&&(this.keyupReliable=!1);e=!this.modifiers.ctrl&&!s.altIsTypableOnly;(!this.modifiers.alt&&this.modifiers.ctrl||e&&this.modifiers.alt||this.modifiers.meta||this.modifiers.hyper)&&(this.reliable=!0),p[this.keyCode]=this.keysym},u=(a.prototype=new n,function(e){n.call(this,e),this.keysym=S(this.keyCode),this.reliable=!0}),c=(u.prototype=new n,function(e){n.call(this,e),this.keysym=T(this.keyCode,this.location)||w(this.key,this.location),o.pressed[this.keysym]||(this.keysym=p[this.keyCode]||this.keysym),this.reliable=!0}),l=(c.prototype=new n,[]),i={8:[65288],9:[65289],12:[65291,65291,65291,65461],13:[65293],16:[65505,65505,65506],17:[65507,65507,65508],18:[65513,65513,65027],19:[65299],20:[65509],27:[65307],32:[32],33:[65365,65365,65365,65465],34:[65366,65366,65366,65459],35:[65367,65367,65367,65457],36:[65360,65360,65360,65463],37:[65361,65361,65361,65460],38:[65362,65362,65362,65464],39:[65363,65363,65363,65462],40:[65364,65364,65364,65458],45:[65379,65379,65379,65456],46:[65535,65535,65535,65454],91:[65511],92:[65512],93:[65383],96:[65456],97:[65457],98:[65458],99:[65459],100:[65460],101:[65461],102:[65462],103:[65463],104:[65464],105:[65465],106:[65450],107:[65451],109:[65453],110:[65454],111:[65455],112:[65470],113:[65471],114:[65472],115:[65473],116:[65474],117:[65475],118:[65476],119:[65477],120:[65478],121:[65479],122:[65480],123:[65481],144:[65407],145:[65300],225:[65027]},h={Again:[65382],AllCandidates:[65341],Alphanumeric:[65328],Alt:[65513,65513,65027],Attn:[64782],AltGraph:[65027],ArrowDown:[65364],ArrowLeft:[65361],ArrowRight:[65363],ArrowUp:[65362],Backspace:[65288],CapsLock:[65509],Cancel:[65385],Clear:[65291],Convert:[65313],Copy:[64789],Crsel:[64796],CrSel:[64796],CodeInput:[65335],Compose:[65312],Control:[65507,65507,65508],ContextMenu:[65383],Delete:[65535],Down:[65364],End:[65367],Enter:[65293],EraseEof:[64774],Escape:[65307],Execute:[65378],Exsel:[64797],ExSel:[64797],F1:[65470],F2:[65471],F3:[65472],F4:[65473],F5:[65474],F6:[65475],F7:[65476],F8:[65477],F9:[65478],F10:[65479],F11:[65480],F12:[65481],F13:[65482],F14:[65483],F15:[65484],F16:[65485],F17:[65486],F18:[65487],F19:[65488],F20:[65489],F21:[65490],F22:[65491],F23:[65492],F24:[65493],Find:[65384],GroupFirst:[65036],GroupLast:[65038],GroupNext:[65032],GroupPrevious:[65034],FullWidth:null,HalfWidth:null,HangulMode:[65329],Hankaku:[65321],HanjaMode:[65332],Help:[65386],Hiragana:[65317],HiraganaKatakana:[65319],Home:[65360],Hyper:[65517,65517,65518],Insert:[65379],JapaneseHiragana:[65317],JapaneseKatakana:[65318],JapaneseRomaji:[65316],JunjaMode:[65336],KanaMode:[65325],KanjiMode:[65313],Katakana:[65318],Left:[65361],Meta:[65511,65511,65512],ModeChange:[65406],NumLock:[65407],PageDown:[65366],PageUp:[65365],Pause:[65299],Play:[64790],PreviousCandidate:[65342],PrintScreen:[65377],Redo:[65382],Right:[65363],RomanCharacters:null,Scroll:[65300],Select:[65376],Separator:[65452],Shift:[65505,65505,65506],SingleCandidate:[65340],Super:[65515,65515,65516],Tab:[65289],UIKeyInputDownArrow:[65364],UIKeyInputEscape:[65307],UIKeyInputLeftArrow:[65361],UIKeyInputRightArrow:[65363],UIKeyInputUpArrow:[65362],Up:[65362],Undo:[65381],Win:[65511,65511,65512],Zenkaku:[65320],ZenkakuHankaku:[65322]},r={65027:!0,65505:!0,65506:!0,65507:!0,65508:!0,65509:!0,65511:!0,65512:!0,65513:!0,65514:!0,65515:!0,65516:!0},d=(this.modifiers=new O.Keyboard.ModifierState,this.pressed={},{}),f={},p={},g=null,y=null,m=function(e,t){return e?e[t]||e[0]:null},v=function(e){return 0<=e&&e<=255||16777216==(4294901760&e)};function w(e,t,n){if(!e)return null;var i=e.indexOf("U+");if(0<=i)var i=e.substring(i+2),r=String.fromCharCode(parseInt(i,16));else{if(1!==e.length||3===t)return m(h[e],t);r=e}return!0===n?r=r.toUpperCase():!1===n&&(r=r.toLowerCase()),S(r.charCodeAt(0))}function S(e){var t;return(t=e)<=31||127<=t&&t<=159?65280|e:0<=e&&e<=255?e:256<=e&&e<=1114111?16777216|e:null}function T(e,t){return m(i[e],t)}var E=function(e,t){var n;return!!t&&(-1===(n=t.indexOf("U+"))||(e!==parseInt(t.substring(n+2),16)||(65<=e&&e<=90||48<=e&&e<=57)))},b=(this.press=function(e){if(null!==e){var t;if(!o.pressed[e])if(o.pressed[e]=!0,o.onkeydown)return t=o.onkeydown(e),f[e]=t,window.clearTimeout(g),window.clearInterval(y),r[e]||(g=window.setTimeout(function(){y=window.setInterval(function(){o.onkeyup(e),o.onkeydown(e)},50)},500)),t;return f[e]||!1}},this.release=function(e){o.pressed[e]&&(delete o.pressed[e],delete d[e],window.clearTimeout(g),window.clearInterval(y),null!==e&&o.onkeyup&&o.onkeyup(e))},this.type=function(e){for(var t=0;t<e.length;t++){var n=S(e.codePointAt?e.codePointAt(t):e.charCodeAt(t));o.press(n),o.release(n)}},this.reset=function(){for(var e in o.pressed)o.release(parseInt(e));l=[]},function(e,t,n){var i,r=n.modifiers[e],e=o.modifiers[e];if(-1===t.indexOf(n.keysym))if(e&&!1===r)for(i=0;i<t.length;i++)o.release(t[i]);else if(!e&&r){for(i=0;i<t.length;i++)if(o.pressed[t[i]])return;e=t[0];n.keysym&&(d[e]=!0),o.press(e)}}),I=function(e){b("alt",[65513,65514,65027],e),b("shift",[65505,65506],e),b("ctrl",[65507,65508],e),b("meta",[65511,65512],e),b("hyper",[65515,65516],e),o.modifiers=e.modifiers},C=function(){for(var e in o.pressed)if(!d[e])return!1;return!0};function k(){var e,t=M();if(t){for(;e=t,null!==(t=M()););return C()&&o.reset(),e.defaultPrevented}}function A(e){return!e[t]&&(e[t]=!0)}var L=function(e){o.modifiers.ctrl&&o.modifiers.alt&&(65<=e&&e<=90||97<=e&&e<=122||(e<=255||16777216==(4278190080&e))&&(o.release(65507),o.release(65508),o.release(65513),o.release(65514)))},M=function(){var e=l[0];if(e){if(!(e instanceof a))return e instanceof c&&!s.keyupUnreliable?(t=e.keysym)?(o.release(t),delete p[e.keyCode],e.defaultPrevented=!0,I(e),l.shift()):(o.reset(),e):l.shift();var t=null,n=[];if(65511===e.keysym||65512===e.keysym){if(1===l.length)return null;if(l[1].keysym!==e.keysym){if(!l[1].modifiers.meta)return l.shift()}else if(l[1]instanceof a)return l.shift()}if(e.reliable?(t=e.keysym,n=l.splice(0,1)):l[1]instanceof u?(t=l[1].keysym,n=l.splice(0,2)):l[1]&&(t=e.keysym,n=l.splice(0,1)),0<n.length){if(I(e),t){L(t);var i=!o.press(t);p[e.keyCode]=t,e.keyupReliable||o.release(t);for(var r=0;r<n.length;r++)n[r].defaultPrevented=i}return e}}return null},R=function(e){return"location"in e?e.location:"keyLocation"in e?e.keyLocation:0};this.listenTo=function(t){t.addEventListener("keydown",function(e){var t;o.onkeydown&&A(e)&&229!==(t=new a(e)).keyCode&&(l.push(t),k()&&e.preventDefault())},!0),t.addEventListener("keypress",function(e){(o.onkeydown||o.onkeyup)&&A(e)&&(l.push(new u(e)),k()&&e.preventDefault())},!0),t.addEventListener("keyup",function(e){o.onkeyup&&A(e)&&(e.preventDefault(),l.push(new c(e)),k())},!0);function n(e){(o.onkeydown||o.onkeyup)&&A(e)&&e.data&&(t.removeEventListener("input",i,!1),o.type(e.data))}var i=function(e){(o.onkeydown||o.onkeyup)&&A(e)&&e.data&&!e.isComposing&&(t.removeEventListener("compositionend",n,!1),o.type(e.data))};t.addEventListener("input",i,!1),t.addEventListener("compositionend",n,!1)},e&&o.listenTo(e)},O.Keyboard._nextID=0,O.Keyboard.ModifierState=function(){this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.hyper=!1},O.Keyboard.ModifierState.fromKeyboardEvent=function(e){var t=new O.Keyboard.ModifierState;return t.shift=e.shiftKey,t.ctrl=e.ctrlKey,t.alt=e.altKey,t.meta=e.metaKey,e.getModifierState&&(t.hyper=e.getModifierState("OS")||e.getModifierState("Super")||e.getModifierState("Hyper")||e.getModifierState("Win")),t},(O=O||{}).Layer=function(e,t){function n(e,t){e=e||0,t=t||0;var n,i,r=Math.ceil(e/s)*s,o=Math.ceil(t/s)*s;a.width!==r||a.height!==o?(n=null,y||0===a.width||0===a.height||((n=document.createElement("canvas")).width=Math.min(p.width,e),n.height=Math.min(p.height,t),n.getContext("2d").drawImage(a,0,0,n.width,n.height,0,0,n.width,n.height)),i=g.globalCompositeOperation,a.width=r,a.height=o,n&&g.drawImage(n,0,0,n.width,n.height,0,0,n.width,n.height),g.globalCompositeOperation=i,c=0,g.save()):p.reset(),p.width=e,p.height=t}var p=this,s=64,a=document.createElement("canvas"),g=a.getContext("2d"),y=(g.save(),!0),u=!0,c=0,i={1:"destination-in",2:"destination-out",4:"source-in",6:"source-atop",8:"source-out",9:"destination-atop",10:"xor",11:"destination-over",12:"copy",14:"source-over",15:"lighter"};function m(e,t,n,i){n+=e,e=i+t,i=n>p.width?n:p.width,t=e>p.height?e:p.height;p.resize(i,t)}this.autosize=!1,this.width=e,this.height=t,this.getCanvas=function(){return a},this.toCanvas=function(){var e=document.createElement("canvas");return e.width=p.width,e.height=p.height,e.getContext("2d").drawImage(p.getCanvas(),0,0),e},this.resize=function(e,t){e===p.width&&t===p.height||n(e,t)},this.drawImage=function(e,t,n){p.autosize&&m(e,t,n.width,n.height),g.drawImage(n,e,t),y=!1},this.transfer=function(e,t,n,i,r,o,s,a){var u=e.getCanvas();if(!(t>=u.width||n>=u.height)&&(t+i>u.width&&(i=u.width-t),n+r>u.height&&(r=u.height-n),0!==i&&0!==r)){p.autosize&&m(o,s,i,r);for(var c=e.getCanvas().getContext("2d").getImageData(t,n,i,r),l=g.getImageData(o,s,i,r),h=0;h<i*r*4;h+=4){var d=new O.Layer.Pixel(c.data[h],c.data[h+1],c.data[h+2],c.data[h+3]),f=new O.Layer.Pixel(l.data[h],l.data[h+1],l.data[h+2],l.data[h+3]);a(d,f),l.data[h]=f.red,l.data[h+1]=f.green,l.data[h+2]=f.blue,l.data[h+3]=f.alpha}g.putImageData(l,o,s),y=!1}},this.put=function(e,t,n,i,r,o,s){var a=e.getCanvas();t>=a.width||n>=a.height||(t+i>a.width&&(i=a.width-t),n+r>a.height&&(r=a.height-n),0!==i&&0!==r&&(p.autosize&&m(o,s,i,r),a=e.getCanvas().getContext("2d").getImageData(t,n,i,r),g.putImageData(a,o,s),y=!1))},this.copy=function(e,t,n,i,r,o,s){e=e.getCanvas();t>=e.width||n>=e.height||(t+i>e.width&&(i=e.width-t),n+r>e.height&&(r=e.height-n),0!==i&&0!==r&&(p.autosize&&m(o,s,i,r),g.drawImage(e,t,n,i,r,o,s,i,r),y=!1))},this.moveTo=function(e,t){u&&(g.beginPath(),u=!1),p.autosize&&m(e,t,0,0),g.moveTo(e,t)},this.lineTo=function(e,t){u&&(g.beginPath(),u=!1),p.autosize&&m(e,t,0,0),g.lineTo(e,t)},this.arc=function(e,t,n,i,r,o){u&&(g.beginPath(),u=!1),p.autosize&&m(e,t,0,0),g.arc(e,t,n,i,r,o)},this.curveTo=function(e,t,n,i,r,o){u&&(g.beginPath(),u=!1),p.autosize&&m(r,o,0,0),g.bezierCurveTo(e,t,n,i,r,o)},this.close=function(){g.closePath(),u=!0},this.rect=function(e,t,n,i){u&&(g.beginPath(),u=!1),p.autosize&&m(e,t,n,i),g.rect(e,t,n,i)},this.clip=function(){g.clip(),u=!0},this.strokeColor=function(e,t,n,i,r,o,s){g.lineCap=e,g.lineJoin=t,g.lineWidth=n,g.strokeStyle="rgba("+i+","+r+","+o+","+s/255+")",g.stroke(),u=!(y=!1)},this.fillColor=function(e,t,n,i){g.fillStyle="rgba("+e+","+t+","+n+","+i/255+")",g.fill(),u=!(y=!1)},this.strokeLayer=function(e,t,n,i){g.lineCap=e,g.lineJoin=t,g.lineWidth=n,g.strokeStyle=g.createPattern(i.getCanvas(),"repeat"),g.stroke(),u=!(y=!1)},this.fillLayer=function(e){g.fillStyle=g.createPattern(e.getCanvas(),"repeat"),g.fill(),u=!(y=!1)},this.push=function(){g.save(),c++},this.pop=function(){0<c&&(g.restore(),c--)},this.reset=function(){for(;0<c;)g.restore(),c--;g.restore(),g.save(),g.beginPath(),u=!1},this.setTransform=function(e,t,n,i,r,o){g.setTransform(e,t,n,i,r,o)},this.transform=function(e,t,n,i,r,o){g.transform(e,t,n,i,r,o)},this.setChannelMask=function(e){g.globalCompositeOperation=i[e]},this.setMiterLimit=function(e){g.miterLimit=e},n(e,t),a.style.zIndex=-1},O.Layer.ROUT=2,O.Layer.ATOP=6,O.Layer.XOR=10,O.Layer.ROVER=11,O.Layer.OVER=14,O.Layer.PLUS=15,O.Layer.RIN=1,O.Layer.IN=4,O.Layer.OUT=8,O.Layer.RATOP=9,O.Layer.SRC=12,O.Layer.Pixel=function(e,t,n,i){this.red=e,this.green=t,this.blue=n,this.alpha=i},(O=O||{}).Mouse=function(i){O.Mouse.Event.Target.call(this);var n=this,r=(this.touchMouseThreshold=3,this.scrollThreshold=53,this.PIXELS_PER_LINE=18,this.PIXELS_PER_PAGE=16*this.PIXELS_PER_LINE,[O.Mouse.State.Buttons.LEFT,O.Mouse.State.Buttons.MIDDLE,O.Mouse.State.Buttons.RIGHT]),o=0,s=0;function e(){o=n.touchMouseThreshold}function t(e){var t=e.deltaY||-e.wheelDeltaY||-e.wheelDelta;if(t?1===e.deltaMode?t=e.deltaY*n.PIXELS_PER_LINE:2===e.deltaMode&&(t=e.deltaY*n.PIXELS_PER_PAGE):t=e.detail*n.PIXELS_PER_LINE,(s+=t)<=-n.scrollThreshold){for(;n.click(O.Mouse.State.Buttons.UP),(s+=n.scrollThreshold)<=-n.scrollThreshold;);s=0}if(s>=n.scrollThreshold){for(;n.click(O.Mouse.State.Buttons.DOWN),(s-=n.scrollThreshold)>=n.scrollThreshold;);s=0}O.Event.DOMEvent.cancelEvent(e)}i.addEventListener("contextmenu",function(e){O.Event.DOMEvent.cancelEvent(e)},!1),i.addEventListener("mousemove",function(e){o?(O.Event.DOMEvent.cancelEvent(e),o--):n.move(O.Position.fromClientPosition(i,e.clientX,e.clientY),e)},!1),i.addEventListener("mousedown",function(e){var t;o?O.Event.DOMEvent.cancelEvent(e):(t=r[e.button])&&n.press(t,e)},!1),i.addEventListener("mouseup",function(e){var t;o?O.Event.DOMEvent.cancelEvent(e):(t=r[e.button])&&n.release(t,e)},!1),i.addEventListener("mouseout",function(e){for(var t=(e=e||window.event).relatedTarget||e.toElement;t;){if(t===i)return;t=t.parentNode}n.reset(e),n.out(e)},!1),i.addEventListener("selectstart",function(e){O.Event.DOMEvent.cancelEvent(e)},!1),i.addEventListener("touchmove",e,!1),i.addEventListener("touchstart",e,!1),i.addEventListener("touchend",e,!1),i.addEventListener("DOMMouseScroll",t,!1),i.addEventListener("mousewheel",t,!1),i.addEventListener("wheel",t,!1);var a=function(){var e=document.createElement("div");if(!("cursor"in e.style))return!1;try{e.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==) 0 0, auto"}catch(e){return!1}return/\burl\([^()]*\)\s+0\s+0\b/.test(e.style.cursor||"")}();this.setCursor=function(e,t,n){return!!a&&(e=e.toDataURL("image/png"),i.style.cursor="url("+e+") "+t+" "+n+", auto",!0)}},O.Mouse.State=function(e){e=1<arguments.length?function(e,t,n,i,r,o,s){return{x:e,y:t,left:n,middle:i,right:r,up:o,down:s}}.apply(this,arguments):e||{},O.Position.call(this,e),this.left=e.left||!1,this.middle=e.middle||!1,this.right=e.right||!1,this.up=e.up||!1,this.down=e.down||!1},O.Mouse.State.Buttons={LEFT:"left",MIDDLE:"middle",RIGHT:"right",UP:"up",DOWN:"down"},O.Mouse.Event=function(e,t,n){O.Event.DOMEvent.call(this,e,n);var i="on"+this.type;this.state=t,this.invokeLegacyHandler=function(e){e[i]&&(this.preventDefault(),this.stopPropagation(),e[i](this.state))}},O.Mouse.Event.Target=function(){O.Event.Target.call(this),this.currentState=new O.Mouse.State,this.press=function(e,t){this.currentState[e]||(this.currentState[e]=!0,this.dispatch(new O.Mouse.Event("mousedown",this.currentState,t)))},this.release=function(e,t){this.currentState[e]&&(this.currentState[e]=!1,this.dispatch(new O.Mouse.Event("mouseup",this.currentState,t)))},this.click=function(e,t){this.press(e,t),this.release(e,t)},this.move=function(e,t){this.currentState.x===e.x&&this.currentState.y===e.y||(this.currentState.x=e.x,this.currentState.y=e.y,this.dispatch(new O.Mouse.Event("mousemove",this.currentState,t)))},this.out=function(e){this.dispatch(new O.Mouse.Event("mouseout",this.currentState,e))},this.reset=function(e){for(var t in O.Mouse.State.Buttons)this.release(O.Mouse.State.Buttons[t],e)}},O.Mouse.Touchpad=function(s){O.Mouse.Event.Target.call(this);var a=this,u=(this.scrollThreshold=20*(window.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=10*(window.devicePixelRatio||1),this.currentState=new O.Mouse.State,0),c=0,l=0,h=0,d=0,i={1:"left",2:"right",3:"middle"},r=!1,o=null;s.addEventListener("touchend",function(e){var t,n;e.preventDefault(),r&&0===e.touches.length&&(t=(new Date).getTime(),n=i[u],a.currentState[n]&&(a.release(n,e),o&&(window.clearTimeout(o),o=null)),t-h<=a.clickTimingThreshold&&d<a.clickMoveThreshold&&(a.press(n,e),o=window.setTimeout(function(){a.release(n,e),r=!1},a.clickTimingThreshold)),o||(r=!1))},!1),s.addEventListener("touchstart",function(e){e.preventDefault(),u=Math.min(e.touches.length,3),o&&(window.clearTimeout(o),o=null),r||(r=!0,e=e.touches[0],c=e.clientX,l=e.clientY,h=(new Date).getTime(),d=0)},!1),s.addEventListener("touchmove",function(e){e.preventDefault();var t,n,i=e.touches[0],r=i.clientX-c,o=i.clientY-l;d+=Math.abs(r)+Math.abs(o),1===u?(t=1+d/((new Date).getTime()-h),(n=new O.Position(a.currentState)).x+=r*t,n.y+=o*t,n.x=Math.min(Math.max(0,n.x),s.offsetWidth-1),n.y=Math.min(Math.max(0,n.y),s.offsetHeight-1),a.move(n,e),c=i.clientX,l=i.clientY):2===u&&Math.abs(o)>=a.scrollThreshold&&(a.click(0<o?"down":"up",e),c=i.clientX,l=i.clientY)},!1)},O.Mouse.Touchscreen=function(n){O.Mouse.Event.Target.call(this);var i=this,r=!1,o=null,s=null,a=null,u=null;function c(e){var e=e.touches[0]||e.changedTouches[0],t=e.clientX-o,e=e.clientY-s;return Math.sqrt(t*t+e*e)>=i.clickMoveThreshold}function l(){window.clearTimeout(a),window.clearTimeout(u),r=!1}this.scrollThreshold=20*(window.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=16*(window.devicePixelRatio||1),this.longPressThreshold=500,n.addEventListener("touchend",function(e){var t;r&&(0!==e.touches.length||1!==e.changedTouches.length?l():(window.clearTimeout(u),i.release(O.Mouse.State.Buttons.LEFT,e),c(e)||(e.preventDefault(),i.currentState.left||(t=e.changedTouches[0],i.move(O.Position.fromClientPosition(n,t.clientX,t.clientY)),i.press(O.Mouse.State.Buttons.LEFT,e),a=window.setTimeout(function(){i.release(O.Mouse.State.Buttons.LEFT,e),l()},i.clickTimingThreshold)))))},!1),n.addEventListener("touchstart",function(t){var e;1!==t.touches.length?l():(t.preventDefault(),e=(e=t).touches[0],r=!0,o=e.clientX,s=e.clientY,window.clearTimeout(a),u=window.setTimeout(function(){var e=t.touches[0];i.move(O.Position.fromClientPosition(n,e.clientX,e.clientY)),i.click(O.Mouse.State.Buttons.RIGHT,t),l()},i.longPressThreshold))},!1),n.addEventListener("touchmove",function(e){var t;r&&(c(e)&&window.clearTimeout(u),1!==e.touches.length?l():i.currentState.left&&(e.preventDefault(),t=e.touches[0],i.move(O.Position.fromClientPosition(n,t.clientX,t.clientY),e)))},!1)},(O=(O=O||{})||{}).Object=function(r,e){var o=this,s={};this.index=e,this.onbody=function(e,t,n){var i,r=(r=s[n=n])?(i=r.shift(),0===r.length&&delete s[n],i):null;r&&r(e,t)},this.onundefine=null,this.requestInputStream=function(e,t){var n,i;t&&(t=t,(i=s[n=e])||(s[n]=i=[]),i.push(t)),r.requestObjectInputStream(o.index,e)},this.createOutputStream=function(e,t){return r.createObjectOutputStream(o.index,e,t)}},O.Object.ROOT_STREAM="/",O.Object.STREAM_INDEX_MIMETYPE="application/vnd.glyptodon.guacamole.stream-index+json",(O=O||{}).OnScreenKeyboard=function(i){var g=this,r={},o={},y=[],m=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},s=function(e,n){e.classList?e.classList.remove(n):e.className=e.className.replace(/([^ ]+)[ ]*/g,function(e,t){return t===n?"":e})},v=0,w=function(t,n,i,r){this.width=n,this.height=i,this.scale=function(e){t.style.width=n*e+"px",t.style.height=i*e+"px",r&&(t.style.lineHeight=i*e+"px",t.style.fontSize=e+"px")}},a=function(e){for(var t=0;t<e.length;t++)if(!(e[t]in r))return!1;return!0},u=function(e){var t=g.keys[e];if(t)for(var n=t.length-1;0<=n;n--){var i=t[n];if(a(i.requires))return i}return null},S=function(e,t){var n,i;o[e]||(m(t,"guac-keyboard-pressed"),(t=u(e)).modifier?(n="guac-keyboard-modifier-"+E(t.modifier),void 0===(i=r[t.modifier])?(m(c,n),r[t.modifier]=t.keysym,t.keysym&&g.onkeydown&&g.onkeydown(t.keysym)):(s(c,n),delete r[t.modifier],i&&g.onkeyup&&g.onkeyup(i))):g.onkeydown&&g.onkeydown(t.keysym),o[e]=!0)},T=function(e,t){o[e]&&(s(t,"guac-keyboard-pressed"),!(t=u(e)).modifier&&g.onkeyup&&g.onkeyup(t.keysym),o[e]=!1)},c=document.createElement("div"),l=(c.className="guac-keyboard",c.onselectstart=c.onmousemove=c.onmouseup=c.onmousedown=function(e){return v&&v--,e.stopPropagation(),!1},this.touchMouseThreshold=3,this.onkeydown=null,this.onkeyup=null,this.layout=new O.OnScreenKeyboard.Layout(i),this.getElement=function(){return c},this.resize=function(e){for(var t=Math.floor(10*e/g.layout.width)/10,n=0;n<y.length;n++)y[n].scale(t)},function(e,t){if(t instanceof Array){for(var n=[],i=0;i<t.length;i++)n.push(new O.OnScreenKeyboard.Key(t[i],e));return n}return"number"==typeof t?[new O.OnScreenKeyboard.Key({name:e,keysym:t})]:"string"==typeof t?[new O.OnScreenKeyboard.Key({name:e,title:t})]:[new O.OnScreenKeyboard.Key(t,e)]}),E=(this.keys=function(e){var t,n={};for(t in i.keys)n[t]=l(t,e[t]);return n}(i.keys),function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[^A-Za-z0-9]+/g,"-").toLowerCase()});(function e(t,n,i){var r=document.createElement("div");if(i&&m(r,"guac-keyboard-"+E(i)),n instanceof Array)for(m(r,"guac-keyboard-group"),s=0;s<n.length;s++)e(r,n[s]);else if(n instanceof Object){m(r,"guac-keyboard-group");for(var o=Object.keys(n).sort(),s=0;s<o.length;s++){i=o[s];e(r,n[i],i)}}else if("number"==typeof n)m(r,"guac-keyboard-gap"),y.push(new w(r,n,n));else if("string"==typeof n){var a=n,u=(1===a.length&&(a="0x"+a.charCodeAt(0).toString(16)),m(r,"guac-keyboard-key-container"),document.createElement("div")),c=(u.className="guac-keyboard-key guac-keyboard-key-"+E(a),g.keys[n]);if(c)for(s=0;s<c.length;s++){var l=c[s],h=document.createElement("div");h.className="guac-keyboard-cap",h.textContent=l.title;for(var d=0;d<l.requires.length;d++){var f=l.requires[d];m(h,"guac-keyboard-requires-"+E(f)),m(u,"guac-keyboard-uses-"+E(f))}u.appendChild(h)}r.appendChild(u),y.push(new w(r,g.layout.keyWidths[n]||1,1,!0));function p(e){e.preventDefault(),0===v&&T(n,u)}u.addEventListener("touchstart",function(e){e.preventDefault(),v=g.touchMouseThreshold,S(n,u)},!0),u.addEventListener("touchend",function(e){e.preventDefault(),v=g.touchMouseThreshold,T(n,u)},!0),u.addEventListener("mousedown",function(e){e.preventDefault(),0===v&&S(n,u)},!0),u.addEventListener("mouseup",p,!0),u.addEventListener("mouseout",p,!0)}t.appendChild(r)})(c,i.layout)},O.OnScreenKeyboard.Layout=function(e){this.language=e.language,this.type=e.type,this.keys=e.keys,this.layout=e.layout,this.width=e.width,this.keyWidths=e.keyWidths||{}},O.OnScreenKeyboard.Key=function(e,t){this.name=t||e.name,this.title=e.title||this.name,this.keysym=e.keysym||((t=this.title)&&1===t.length?0<=(t=t.charCodeAt(0))&&t<=255?t:256<=t&&t<=1114111?16777216|t:null:null),this.modifier=e.modifier,this.requires=e.requires||[]},(O=O||{}).OutputStream=function(t,e){var n=this;this.index=e,this.onack=null,this.sendBlob=function(e){t.sendBlob(n.index,e)},this.sendEnd=function(){t.endStream(n.index)}}}(O=O||{}).Parser=function(){var i=this,r="",o=[],s=-1,a=0;this.receive=function(e){for(4096<a&&a<=s&&(r=r.substring(a),s-=a,a=0),r+=e;s<r.length;){if(a<=s){var t=r.substring(a,s),n=r.substring(s,s+1);if(o.push(t),";"==n){t=o.shift();null!=i.oninstruction&&i.oninstruction(t,o),o.length=0}else if(","!=n)throw new Error("Illegal terminator.");a=s+1}t=r.indexOf(".",a);if(-1==t){a=r.length;break}n=parseInt(r.substring(s+1,t));if(isNaN(n))throw new Error("Non-numeric character in element length.");s=(a=t+1)+n}},this.oninstruction=null},(O=O||{}).Position=function(e){this.x=(e=e||{}).x||0,this.y=e.y||0,this.fromClientPosition=function(e,t,n){this.x=t-e.offsetLeft,this.y=n-e.offsetTop;for(var i=e.offsetParent;i&&i!==document.body;)this.x-=i.offsetLeft-i.scrollLeft,this.y-=i.offsetTop-i.scrollTop,i=i.offsetParent;i&&(t=document.body.scrollLeft||document.documentElement.scrollLeft,n=document.body.scrollTop||document.documentElement.scrollTop,this.x-=i.offsetLeft-t,this.y-=i.offsetTop-n)}},O.Position.fromClientPosition=function(e,t,n){var i=new O.Position;return i.fromClientPosition(e,t,n),i},(O=O||{}).RawAudioFormat=function(e){this.bytesPerSample=e.bytesPerSample,this.channels=e.channels,this.rate=e.rate},O.RawAudioFormat.parse=function(e){var t,n=null,i=1;if("audio/L8;"===e.substring(0,9))e=e.substring(9),t=1;else{if("audio/L16;"!==e.substring(0,10))return null;e=e.substring(10),t=2}for(var r=e.split(","),o=0;o<r.length;o++){var s=r[o],a=s.indexOf("=");if(-1===a)return null;var u=s.substring(0,a),c=s.substring(a+1);switch(u){case"channels":i=parseInt(c);break;case"rate":n=parseInt(c);break;default:return null}}return null===n?null:new O.RawAudioFormat({bytesPerSample:t,channels:i,rate:n})},(O=O||{}).SessionRecording=function(t){function o(e,t,n){var i,r;return e===t?e:(i=Math.floor((e+t)/2),n<(r=g(l[i].timestamp))&&e<i?o(e,i-1,n):r<n&&i<t?o(i+1,t,n):i)}function n(){var e;d+1<l.length?(e=l[d+1].timestamp-f+p,e=Math.max(e-(new Date).getTime(),0),m(d+1,function(){n()},e)):u.pause()}var u=this,c=5,l=[],i=[],r=0,s=0,a=new O.SessionRecording._PlaybackTunnel,h=new O.Client(a),d=-1,f=null,p=null,e=null,g=(h.connect(),h.getDisplay().showCursor(!1),t.oninstruction=function(e,t){var n=new O.SessionRecording._Frame.Instruction(e,t.slice());i.push(n),r+=n.getSize(),"sync"===e&&(n=parseInt(t[0]),e=new O.SessionRecording._Frame(n,i),l.push(e),(1===l.length||16384<=r&&5e3<=n-s)&&(e.keyframe=!0,s=n,r=0),i=[],u.onprogress&&u.onprogress(u.getDuration()))},function(e){return 0===l.length?0:e-l[0].timestamp}),y=function(e){for(var t=l[e],n=0;n<t.instructions.length;n++){var i=t.instructions[n];a.receiveInstruction(i.opcode,i.args)}t.keyframe&&!t.clientState&&h.exportState(function(e){t.clientState=e})},m=function r(o,s,a){v(),e=window.setTimeout(function(){for(var e=o;0<=e;e--){var t=l[e];if(e===d)break;if(t.clientState){h.importState(t.clientState);break}}e++;for(var n=(new Date).getTime();e<=o;e++){var i=(new Date).getTime();if(c<=i-n)break;y(e)}d=e-1,u.onseek&&u.onseek(u.getPosition()),d!==o?r(o,s,Math.max(a-((new Date).getTime()-n),0)):s()},a||0)},v=function(){window.clearTimeout(e)};this.onprogress=null,this.onplay=null,this.onpause=null,this.onseek=null,this.connect=function(e){t.connect(e)},this.disconnect=function(){t.disconnect()},this.getDisplay=function(){return h.getDisplay()},this.isPlaying=function(){return!!f},this.getPosition=function(){return-1===d?0:g(l[d].timestamp)},this.getDuration=function(){return 0===l.length?0:g(l[l.length-1].timestamp)},this.play=function(){var e;!u.isPlaying()&&d+1<l.length&&(u.onplay&&u.onplay(),e=l[d+1],f=e.timestamp,p=(new Date).getTime(),n())},this.seek=function(e,t){var n;0!==l.length&&(n=u.isPlaying(),u.pause(),m(o(0,l.length-1,e),function(){n&&u.play(),t&&t()}))},this.pause=function(){v(),u.isPlaying()&&(u.onpause&&u.onpause(),p=f=null)}},O.SessionRecording._Frame=function(e,t){this.keyframe=!1,this.timestamp=e,this.instructions=t,this.clientState=null},O.SessionRecording._Frame.Instruction=function(e,t){var n=this;this.opcode=e,this.args=t,this.getSize=function(){for(var e=n.opcode.length,t=0;t<n.args.length;t++)e+=n.args[t].length;return e}},O.SessionRecording._PlaybackTunnel=function(){var n=this;this.connect=function(e){},this.sendMessage=function(e){},this.disconnect=function(){},this.receiveInstruction=function(e,t){n.oninstruction&&n.oninstruction(e,t)}},(O=O||{}).Status=function(e,t){var n=this;this.code=e,this.message=t,this.isError=function(){return n.code<0||255<n.code}},O.Status.Code={SUCCESS:0,UNSUPPORTED:256,SERVER_ERROR:512,SERVER_BUSY:513,UPSTREAM_TIMEOUT:514,UPSTREAM_ERROR:515,RESOURCE_NOT_FOUND:516,RESOURCE_CONFLICT:517,RESOURCE_CLOSED:518,UPSTREAM_NOT_FOUND:519,UPSTREAM_UNAVAILABLE:520,SESSION_CONFLICT:521,SESSION_TIMEOUT:522,SESSION_CLOSED:523,CLIENT_BAD_REQUEST:768,CLIENT_UNAUTHORIZED:769,CLIENT_FORBIDDEN:771,CLIENT_TIMEOUT:776,CLIENT_OVERRUN:781,CLIENT_BAD_TYPE:783,CLIENT_TOO_MANY:797},O.Status.Code.fromHTTPCode=function(e){switch(e){case 400:return O.Status.Code.CLIENT_BAD_REQUEST;case 403:return O.Status.Code.CLIENT_FORBIDDEN;case 404:return O.Status.Code.RESOURCE_NOT_FOUND;case 429:return O.Status.Code.CLIENT_TOO_MANY;case 503:return O.Status.Code.SERVER_BUSY}return O.Status.Code.SERVER_ERROR},O.Status.Code.fromWebSocketCode=function(e){switch(e){case 1e3:return O.Status.Code.SUCCESS;case 1006:case 1015:return O.Status.Code.UPSTREAM_NOT_FOUND;case 1001:case 1012:case 1013:case 1014:return O.Status.Code.UPSTREAM_UNAVAILABLE}return O.Status.Code.SERVER_ERROR},(O=O||{}).StringReader=function(e){var t=this,e=new O.ArrayBufferReader(e),o=0,s=0;e.ondata=function(e){e=function(e){for(var t="",n=new Uint8Array(e),i=0;i<n.length;i++){var r=n[i];0===o?127==(127|r)?t+=String.fromCharCode(r):223==(31|r)?(s=31&r,o=1):239==(15|r)?(s=15&r,o=2):247==(7|r)?(s=7&r,o=3):t+="":191==(63|r)?(s=s<<6|63&r,0===--o&&(t+=String.fromCharCode(s))):(o=0,t+="")}return t}(e);t.ontext&&t.ontext(e)},e.onend=function(){t.onend&&t.onend()},this.ontext=null,this.onend=null},(O=O||{}).StringWriter=function(e){var t=this,n=new O.ArrayBufferWriter(e),a=new Uint8Array(8192),u=0;function c(e){var t,n,i,r;if(e<=127)t=0,n=1;else if(e<=2047)t=192,n=2;else if(e<=65535)t=224,n=3;else{if(!(e<=2097151))return void c(65533);t=240,n=4}u+(i=n)>=a.length&&((r=new Uint8Array(2*(u+i))).set(a),a=r);for(var o=(u+=i)-1,s=1;s<n;s++)a[o--]=128|63&e,e>>=6;a[o]=t|e}n.onack=function(e){t.onack&&t.onack(e)},this.sendText=function(e){e.length&&n.sendData(function(e){for(var t,n=0;n<e.length;n++)c(e.charCodeAt(n));if(0<u)return t=a.subarray(0,u),u=0,t}(e))},this.sendEnd=function(){n.sendEnd()},this.onack=null},(O=O||{}).Touch=function(o){O.Event.Target.call(this);var s=this,r=Math.floor(16*window.devicePixelRatio);this.touches={},this.activeTouches=0,o.addEventListener("touchstart",function(e){for(var t=0;t<e.changedTouches.length;t++){var n=e.changedTouches[t],i=n.identifier;s.touches[i]||(i=s.touches[i]=new O.Touch.State({id:i,radiusX:n.radiusX||r,radiusY:n.radiusY||r,angle:n.angle||0,force:n.force||1}),s.activeTouches++,i.fromClientPosition(o,n.clientX,n.clientY),s.dispatch(new O.Touch.Event("touchmove",e,i)))}},!1),o.addEventListener("touchmove",function(e){for(var t=0;t<e.changedTouches.length;t++){var n=e.changedTouches[t],i=n.identifier,i=s.touches[i];i&&(n.force&&(i.force=n.force),i.angle=n.angle||0,i.radiusX=n.radiusX||r,i.radiusY=n.radiusY||r,i.fromClientPosition(o,n.clientX,n.clientY),s.dispatch(new O.Touch.Event("touchmove",e,i)))}},!1),o.addEventListener("touchend",function(e){for(var t=0;t<e.changedTouches.length;t++){var n=e.changedTouches[t],i=n.identifier,r=s.touches[i];r&&(delete s.touches[i],s.activeTouches--,r.force=0,r.fromClientPosition(o,n.clientX,n.clientY),s.dispatch(new O.Touch.Event("touchend",e,r)))}},!1)},O.Touch.State=function(e){O.Position.call(this,e=e||{}),this.id=e.id||0,this.radiusX=e.radiusX||0,this.radiusY=e.radiusY||0,this.angle=e.angle||0,this.force=e.force||1},O.Touch.Event=function(e,t,n){O.Event.DOMEvent.call(this,e,[t]),this.state=n},(O=O||{}).Tunnel=function(){this.connect=function(e){},this.disconnect=function(){},this.sendMessage=function(e){},this.setState=function(e){e!==this.state&&(this.state=e,this.onstatechange&&this.onstatechange(e))},this.setUUID=function(e){this.uuid=e,this.onuuid&&this.onuuid(e)},this.isConnected=function(){return this.state===O.Tunnel.State.OPEN||this.state===O.Tunnel.State.UNSTABLE},this.state=O.Tunnel.State.CONNECTING,this.receiveTimeout=15e3,this.unstableThreshold=1500,this.uuid=null,this.onuuid=null,this.onerror=null,this.onstatechange=null,this.oninstruction=null},O.Tunnel.INTERNAL_DATA_OPCODE="",O.Tunnel.State={CONNECTING:0,OPEN:1,CLOSED:2,UNSTABLE:3},O.HTTPTunnel=function(e,t,n){var d=this,i=e+"?connect",r=e+"?read:",o=e+"?write:",f=1,s=!1,a="",u=!!t,c=null,l=null,h=null,p=n||{},g="Guacamole-Tunnel-Token",y=null;function m(e,t){for(var n in t)e.setRequestHeader(n,t[n])}function v(){window.clearTimeout(c),window.clearTimeout(l),d.state===O.Tunnel.State.UNSTABLE&&d.setState(O.Tunnel.State.OPEN),c=window.setTimeout(function(){w(new O.Status(O.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},d.receiveTimeout),l=window.setTimeout(function(){d.setState(O.Tunnel.State.UNSTABLE)},d.unstableThreshold)}function w(e){window.clearTimeout(c),window.clearTimeout(l),window.clearInterval(h),d.state!==O.Tunnel.State.CLOSED&&(e.code===O.Status.Code.SUCCESS||!d.onerror||d.state!==O.Tunnel.State.CONNECTING&&e.code===O.Status.Code.RESOURCE_NOT_FOUND||d.onerror(e),s=!1,d.setState(O.Tunnel.State.CLOSED))}function S(e){var t,n=parseInt(e.getResponseHeader("Guacamole-Status-Code"));n?(t=e.getResponseHeader("Guacamole-Error-Message"),w(new O.Status(n,t))):e.status?w(new O.Status(O.Status.Code.fromHTTPCode(e.status),e.statusText)):w(new O.Status(O.Status.Code.UPSTREAM_NOT_FOUND))}this.sendMessage=function(){if(d.isConnected()&&0!==arguments.length){for(var e=n(arguments[0]),t=1;t<arguments.length;t++)e+=","+n(arguments[t]);a+=e+=";",s||!function e(){if(!d.isConnected())return;{var t;0<a.length?(s=!0,(t=new XMLHttpRequest).open("POST",o+d.uuid),t.withCredentials=u,m(t,p),t.setRequestHeader("Content-type","application/octet-stream"),t.setRequestHeader(g,y),t.onreadystatechange=function(){4===t.readyState&&(v(),200!==t.status?S(t):e())},t.send(a),a=""):s=!1}}()}function n(e){e=new String(e);return e.length+"."+e}};var T=0;function E(){var e=new XMLHttpRequest;return e.open("GET",r+d.uuid+":"+T++),e.setRequestHeader(g,y),e.withCredentials=u,m(e,p),e.send(null),e}this.connect=function(e){v(),d.setState(O.Tunnel.State.CONNECTING);var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&(200!==t.status?S(t):(v(),d.setUUID(t.responseText),(y=t.getResponseHeader(g))?(d.setState(O.Tunnel.State.OPEN),h=setInterval(function(){d.sendMessage("nop")},500),function r(o){var s=null,a=null,e=0,u=-1,c=0,l=new Array;function h(){if(d.isConnected()){if(!(o.readyState<2)){var t,e;try{t=o.status}catch(e){t=200}if(a||200!==t||(a=E()),3===o.readyState||4===o.readyState)if(v(),1===f&&(3!==o.readyState||s?4===o.readyState&&s&&clearInterval(s):s=setInterval(h,30)),0===o.status)d.disconnect();else if(200!==o.status)S(o);else{try{e=o.responseText}catch(e){return}for(;u<e.length;){c<=u&&(i=e.substring(c,u),n=e.substring(u,u+1),l.push(i),";"===n&&(i=l.shift(),d.oninstruction&&d.oninstruction(i,l),l.length=0),c=u+1);var n=e.indexOf(".",c);if(-1===n){c=e.length;break}var i=parseInt(e.substring(u+1,n));if(0===i){s&&clearInterval(s),o.onreadystatechange=null,o.abort(),a&&r(a);break}u=(c=n+1)+i}}}}else null!==s&&clearInterval(s)}o.onreadystatechange=1===f?function(){3===o.readyState&&2<=++e&&(f=0,o.onreadystatechange=h),h()}:h,h()}(E())):w(new O.Status(O.Status.Code.UPSTREAM_NOT_FOUND))))},t.open("POST",i,!0),t.withCredentials=u,m(t,p),t.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),t.send(e)},this.disconnect=function(){w(new O.Status(O.Status.Code.SUCCESS,"Manually closed."))}},O.HTTPTunnel.prototype=new O.Tunnel,O.WebSocketTunnel=function(t){var e,n,a=this,r=null,i=null,o=null,s=null;function u(){window.clearTimeout(i),window.clearTimeout(o),a.state===O.Tunnel.State.UNSTABLE&&a.setState(O.Tunnel.State.OPEN),i=window.setTimeout(function(){c(new O.Status(O.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},a.receiveTimeout),o=window.setTimeout(function(){a.setState(O.Tunnel.State.UNSTABLE)},a.unstableThreshold)}function c(e){window.clearTimeout(i),window.clearTimeout(o),window.clearInterval(s),a.state!==O.Tunnel.State.CLOSED&&(e.code!==O.Status.Code.SUCCESS&&a.onerror&&a.onerror(e),a.setState(O.Tunnel.State.CLOSED),r.close())}"ws:"!==t.substring(0,3)&&"wss:"!==t.substring(0,4)&&(e={"http:":"ws:","https:":"wss:"}[window.location.protocol],t="/"===t.substring(0,1)?e+"//"+window.location.host+t:(n=window.location.pathname.lastIndexOf("/"),n=window.location.pathname.substring(0,n+1),e+"//"+window.location.host+n+t)),this.sendMessage=function(e){if(a.isConnected()&&0!==arguments.length){for(var t=i(e),n=1;n<arguments.length;n++)t+=","+i(arguments[n]);r.send(t+=";")}function i(e){e=new String(e);return e.length+"."+e}},this.connect=function(e){u(),a.setState(O.Tunnel.State.CONNECTING),(r=new WebSocket(t+"?"+e,"guacamole")).onopen=function(e){u(),s=setInterval(function(){a.sendMessage(O.Tunnel.INTERNAL_DATA_OPCODE,"ping",(new Date).getTime())},500)},r.onclose=function(e){e.reason?c(new O.Status(parseInt(e.reason),e.reason)):e.code?c(new O.Status(O.Status.Code.fromWebSocketCode(e.code))):c(new O.Status(O.Status.Code.UPSTREAM_NOT_FOUND))},r.onmessage=function(e){u();var t=e.data,n=0,i=[];do{var r,o=t.indexOf(".",n),o=(-1!==o?r=(n=o+1)+parseInt(t.substring(r+1,o)):c(new O.Status(O.Status.Code.SERVER_ERROR,"Incomplete instruction.")),t.substring(n,r)),s=t.substring(r,r+1)}while(i.push(o),";"===s&&(o=i.shift(),null===a.uuid&&(o===O.Tunnel.INTERNAL_DATA_OPCODE&&a.setUUID(i[0]),a.setState(O.Tunnel.State.OPEN)),o!==O.Tunnel.INTERNAL_DATA_OPCODE&&a.oninstruction&&a.oninstruction(o,i),i.length=0),(n=r+1)<t.length)}},this.disconnect=function(){c(new O.Status(O.Status.Code.SUCCESS,"Manually closed."))}},O.WebSocketTunnel.prototype=new O.Tunnel,O.ChainedTunnel=function(e){for(var r,o=this,s=[],a=null,t=0;t<arguments.length;t++)s.push(arguments[t]);function u(t){o.disconnect=t.disconnect,o.sendMessage=t.sendMessage;function n(e){return e&&e.code===O.Status.Code.UPSTREAM_TIMEOUT?(s=[],null):((e=s.shift())&&(t.onerror=null,t.oninstruction=null,t.onstatechange=null,u(e)),e)}function i(){t.onstatechange=o.onstatechange,t.oninstruction=o.oninstruction,t.onerror=o.onerror,t.onuuid=o.onuuid,t.uuid&&o.setUUID(t.uuid),a=t}t.onstatechange=function(e){switch(e){case O.Tunnel.State.OPEN:i(),o.onstatechange&&o.onstatechange(e);break;case O.Tunnel.State.CLOSED:!n()&&o.onstatechange&&o.onstatechange(e)}},t.oninstruction=function(e,t){i(),o.oninstruction&&o.oninstruction(e,t)},t.onerror=function(e){!n(e)&&o.onerror&&o.onerror(e)},t.connect(r)}this.connect=function(e){r=e;e=a||s.shift();e?u(e):o.onerror&&o.onerror(O.Status.Code.SERVER_ERROR,"No tunnels to try.")}},O.ChainedTunnel.prototype=new O.Tunnel,O.StaticHTTPTunnel=function(s,a,e){var u=this,c=null,l=e||{};this.sendMessage=function(e){},this.connect=function(e){u.disconnect(),u.setState(O.Tunnel.State.CONNECTING),(c=new XMLHttpRequest).open("GET",s),c.withCredentials=!!a;var t,n=c,i=l;for(t in i)n.setRequestHeader(t,i[t]);c.responseType="text",c.send(null);var r=0,o=new O.Parser;o.oninstruction=function(e,t){u.oninstruction&&u.oninstruction(e,t)},c.onreadystatechange=function(){var e,t;3!==c.readyState&&4!==c.readyState||(u.setState(O.Tunnel.State.OPEN),t=(e=c.responseText).length,r<t&&(o.receive(e.substring(r)),r=t)),4===c.readyState&&u.disconnect()},c.onerror=function(){u.onerror&&u.onerror(new O.Status(O.Status.Code.fromHTTPCode(c.status),c.statusText)),u.disconnect()}},this.disconnect=function(){c&&(c.abort(),c=null),u.setState(O.Tunnel.State.CLOSED)}},O.StaticHTTPTunnel.prototype=new O.Tunnel,(O=O||{}).API_VERSION="1.4.0",(O=O||{}).VideoPlayer=function(){this.sync=function(){}},O.VideoPlayer.isSupportedType=function(e){return!1},O.VideoPlayer.getSupportedTypes=function(){return[]},O.VideoPlayer.getInstance=function(e,t,n){return null},t.exports=O},{}]},{},[1]);